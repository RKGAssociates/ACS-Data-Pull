labels <- read_excel(full_path,sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
labels <- labels[1:3]
tables <- labels[2]
titles <- labels[3]
vars <- load_variables(acs_year, "acs5")
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = "acs5")
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
fin_df <- df
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,fin_df)
if(i==1){sexage.func(df)} else {fin_df <- df}
}
# save ----
saveWorkbook(wb,"Data.xlsx",overwrite = T)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
labels <- labels[1:3]
tables <- labels[2]
titles <- labels[3]
vars <- load_variables(acs_year, "acs5")
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = "acs5")
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
fin_df <- df
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,fin_df)
if(i==1){sexage.func(df)} else {fin_df <- df}
}
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data.xlsx"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
labels_edit <- labels[1:3]
tables_1 <- labels_edit[2]
tables_2 <- labels[2]
View(tables_1)
View(tables_2)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data.xlsx"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
fin_df <- df
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,fin_df)
if(i==1){sexage.func(df)} else {fin_df <- df}
}
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data.xlsx"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,df)
if(i==1){sexage.func(df)} else {fin_df <- df}
}
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data.xlsx"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,df)
if(i==1){sexage.func(df)} else {break}
}
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
write_file <- "Data.xlsx"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- 011
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,df)
if(i==1){sexage.func(df)}
}
# save ----
saveWorkbook(wb,paste(path,write_file,sep=""),overwrite = T)
fips_codes
fips_codes$county[2]
fips_codes$county[fips_codes$county_code[cnt]]
fips_codes$county[fips_codes$county_code[cnty]]
fips_codes[cnty]
which(fips_codes$county_code==cnty)
which(fips_codes$county_code == cnty)
View(fips_codes)
which(fips_codes==011)
which(fips_codes$county_code == 013)
which(fips_codes)
fips_codes
fips
fips <- data(fips_codes)
fips
View(fin_df)
View(fips_codes)
which(fips_codes$state_name=="Alabama")
which(fips_codes$county_code==001)
which(fips_codes$county_code==003)
which(fips_codes$county_code=="003")
which(fips_codes$county_code=="003" & fips_codes$state_code=="33")
View(fips_codes)
str(33)
as.str(33)
str("33")
str(33)
a <- str(33)
a
rm a
rm(a)
toString(33)
View(fips_codes)
which(fips_codes$county_code==toString(cnty) & fips_codes$state_code==toString(st))
st <- 33
cnty <- 011
which(fips_codes$county_code==toString(cnty) & fips_codes$state_code==toString(st))
which(fips_codes$county_code==toString(cnty))
which(fips_codes$county_code==cnty)
which(fips_codes$county_code=="011")
cnty_string <- toString(cnty)
cnty_string
which(fips_codes$county_code==cnty_string)
which(fips_codes$county_code==cnty)
which(fips_codes$county_code==cnty)
which(fips_codes$county_code==cnty)
which(fips_codes$county_code==cnty)
type(cnty)
dtype(cnty)
?type
typeof(cnty)
typeof(cnty_string)
typeof("011")
which(fips_codes$county_code==cnty_string)
which(fips_codes$county_code=="011")
cnty
cnty_string
cnty <- 011
st <- "NH"
cnty <- "Hillsborough county"
survey_type <- "acs5"
write_file <- paste(cnty,st,"Data.xlsx",sep="_")
write_file
cnty <- str_replace(cnty," ","_")
cnty
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- "Hillsborough county"
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type, cache = TRUE)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb setup ----
# wb <- createWorkbook()
wb <- loadWorkbook(full_path)
# loop ----
j <- nrow(tables)
for(i in 1:j) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,df)
if(i==1){sexage.func(df)}
}
# save ----
cnty <- str_replace(cnty," ","_")
write_file <- paste(cnty,st,"Data.xlsx",sep="_")
saveWorkbook(wb,write_file,overwrite = T)
# save ----
cnty <- str_replace(cnty," ","_")
write_file <- paste(data_path,cnty,st,"Data.xlsx",sep="_")
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
data_path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- "Hillsborough county"
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(data_path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type, cache = TRUE)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb setup ----
# wb <- createWorkbook()
wb <- loadWorkbook(paste(data_path,read_file,sep=""))
# save ----
cnty <- str_replace(cnty," ","_")
cnty
write_file <- paste(data_path,cnty,st,"Data.xlsx",sep="_")
write_file
# save ----
cnty <- str_replace(cnty," ","_")
cnty
write_file <- paste(data_path,cnty,st,"Data.xlsx",sep="_")
write_file
cnty
# save ----
cnty <- str_replace(cnty," ","_")
write_file <- paste(cnty,st,"Data.xlsx",sep="_")
write_file <- paste(data_path,write_file,sep="")
write_file
library(tidyverse)
library(tidycensus)
library(readxl)
library(openxlsx)
###
source("funcs.r")
###
# Parameters ----
setwd("~/Documents/career/RKG/code/RKG-Data-Pull")
data_path <- "~/Documents/career/RKG/data/"
read_file <- "Data Pull_NashuaNH.xlsx"
var_sheet <- "Data Pull"
census_api_key("2f7688b42a2c229e0662079bf0f4f5400cbb7551")
# inputs ----
acs_year <- 2013
geo_level <- "county"
st <- "NH"
cnty <- "Hillsborough county"
survey_type <- "acs5"
# labels/vars ----
labels <- read_excel(paste(data_path,read_file,sep=""),sheet=var_sheet)
labels <- filter(labels, Source=="ACS Data")
tables <- labels[2]
vars <- load_variables(acs_year, survey_type, cache = TRUE)
vars <- select(vars, "name","label")
vars <- rename(vars, "variable"="name")
# wb setup ----
# wb <- createWorkbook()
wb <- loadWorkbook(paste(data_path,read_file,sep=""))
# loop ----
for(i in 1:nrow(tables)) {
df <- get_acs(geography=geo_level,
table = tables[[i,1]],
state = st,
county = cnty,
year = acs_year,
survey = survey_type)
# df <- df %>%
# filter(str_detect(NAME, 'Nashua city'))
sht <- tables[[i,1]]
addWorksheet(wb,sht)
writeData(wb,sht,df)
if(i==1){sexage.func(df)}
}
# save ----
cnty <- str_replace(cnty," ","_")
write_file <- paste(cnty,st,"Data.xlsx",sep="_")
write_file <- paste(data_path,write_file,sep="")
saveWorkbook(wb,write_file,overwrite = T)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
source('~/Documents/career/RKG/code/RKG-Data-Pull/get_data.R', echo=TRUE)
